<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatGPT Output Editor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .main-content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2d3436;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            border-radius: 2px;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 20px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-family: inherit;
            font-size: 1rem;
            line-height: 1.6;
            resize: vertical;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        textarea:focus {
            outline: none;
            border-color: #74b9ff;
            box-shadow: 0 0 0 3px rgba(116, 185, 255, 0.1);
            background: white;
        }

        .editor-container {
            position: relative;
            margin-bottom: 20px;
        }

        .char-counter {
            position: absolute;
            bottom: 10px;
            right: 15px;
            font-size: 0.85rem;
            color: #6c757d;
            background: rgba(255, 255, 255, 0.9);
            padding: 4px 8px;
            border-radius: 6px;
        }

        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 30px;
        }

        button {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        button:active {
            transform: translateY(0);
        }

        .stats {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 12px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #74b9ff;
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 5px;
        }

        .history {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .history-item {
            padding: 10px;
            border-left: 3px solid #74b9ff;
            margin-bottom: 10px;
            background: white;
            border-radius: 0 8px 8px 0;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .history-item:hover {
            background: #e3f2fd;
            transform: translateX(5px);
        }

        .history-time {
            font-size: 0.8rem;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .history-preview {
            font-size: 0.9rem;
            color: #2d3436;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .button-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ü§ñ AI Prompt Editor & Generator</h1>
            <p>Create prompts, generate AI content, and refine your output with powerful editing tools</p>
        </header>
        
        <main class="main-content">
            <section class="section">
                <h2 class="section-title">üîë OpenAI API Configuration</h2>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px; border-left: 4px solid #ffc107;">
                    <h4 style="color: #856404; margin-bottom: 10px;">üîê Security Options:</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="radio" name="securityMode" value="session" checked onchange="updateSecurityMode()">
                            <span>Session Only (Most Secure)</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="radio" name="securityMode" value="encrypted" onchange="updateSecurityMode()">
                            <span>Encrypted Storage</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="radio" name="securityMode" value="environment" onchange="updateSecurityMode()">
                            <span>Environment Variable</span>
                        </label>
                    </div>
                </div>
                
                <div id="sessionMode" class="security-mode">
                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div>
                            <input type="password" id="apiKey" placeholder="Enter your OpenAI API key (sk-...)" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 1rem;">
                            <p style="font-size: 0.85rem; color: #6c757d; margin-top: 5px;">üîí Key stored in memory only - cleared when you close the tab</p>
                        </div>
                        <div>
                            <select id="modelSelect" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 1rem;">
                                <option value="gpt-4o">GPT-4o (Best Quality)</option>
                                <option value="gpt-4o-mini" selected>GPT-4o Mini (Fast & Cheap)</option>
                                <option value="gpt-3.5-turbo">GPT-3.5 Turbo (Cheapest)</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div id="encryptedMode" class="security-mode" style="display: none;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div>
                            <input type="password" id="masterPassword" placeholder="Master Password" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 1rem;">
                            <p style="font-size: 0.85rem; color: #6c757d; margin-top: 5px;">üîê Used to encrypt your API key</p>
                        </div>
                        <div>
                            <input type="password" id="encryptedApiKey" placeholder="API Key (sk-...)" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 1rem;">
                            <p style="font-size: 0.85rem; color: #6c757d; margin-top: 5px;">üîí Encrypted and stored locally</p>
                        </div>
                        <div>
                            <select id="encryptedModelSelect" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 1rem;">
                                <option value="gpt-4o">GPT-4o (Best Quality)</option>
                                <option value="gpt-4o-mini" selected>GPT-4o Mini (Fast & Cheap)</option>
                                <option value="gpt-3.5-turbo">GPT-3.5 Turbo (Cheapest)</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div id="environmentMode" class="security-mode" style="display: none;">
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #1976d2; margin-bottom: 10px;">üí° Environment Variable Setup:</h4>
                        <p style="color: #1976d2; margin-bottom: 10px;">For maximum security, set your API key as an environment variable:</p>
                        <code style="background: #333; color: #fff; padding: 8px; border-radius: 4px; display: block; margin-bottom: 10px;">
                            export OPENAI_API_KEY="sk-your-key-here"
                        </code>
                        <p style="color: #1976d2; font-size: 0.9rem;">‚ö†Ô∏è This method requires a backend server to access environment variables securely.</p>
                    </div>
                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 15px;">
                        <div>
                            <input type="text" id="envApiKey" placeholder="Environment variable will be loaded automatically" disabled style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 1rem; background: #f8f9fa;">
                        </div>
                        <div>
                            <select id="envModelSelect" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 1rem;">
                                <option value="gpt-4o">GPT-4o (Best Quality)</option>
                                <option value="gpt-4o-mini" selected>GPT-4o Mini (Fast & Cheap)</option>
                                <option value="gpt-3.5-turbo">GPT-3.5 Turbo (Cheapest)</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="button-group" style="margin-top: 0; margin-bottom: 0;">
                    <button class="btn-secondary" onclick="testApiKey()">üîß Test API Key</button>
                    <button class="btn-info" onclick="showPricing()">üí∞ View Pricing</button>
                    <button class="btn-primary" onclick="showSecurityInfo()">üõ°Ô∏è Security Info</button>
                </div>
            </section>

            <section class="section">
                <h2 class="section-title">üí° Create Your Prompt</h2>
                <div class="editor-container">
                    <textarea id="promptText" placeholder="Write your custom prompt here... (e.g., 'Write a professional email about project updates' or 'Create a blog post about sustainable living')"></textarea>
                    <div class="char-counter" id="promptCounter">0 characters</div>
                </div>
                <div class="button-group" style="margin-top: 15px; margin-bottom: 0;">
                    <button class="btn-info" onclick="savePrompt()">üíæ Save Prompt</button>
                    <button class="btn-secondary" onclick="copyPrompt()">üìã Copy Prompt</button>
                    <button class="btn-primary" onclick="generateWithAI()" id="generateBtn">üöÄ Generate with AI</button>
                    <button class="btn-primary" onclick="loadPromptTemplate()">üìù Load Template</button>
                </div>
            </section>

            <section class="section">
                <h2 class="section-title">ü§ñ AI Generated Content</h2>
                <div class="editor-container">
                    <textarea id="originalText" placeholder="Generated AI content will appear here, or paste your own ChatGPT output..."></textarea>
                    <div class="char-counter" id="originalCounter">0 characters</div>
                </div>
            </section>

            <section class="section">
                <h2 class="section-title">‚úèÔ∏è Edit Your Content</h2>
                <div class="editor-container">
                    <textarea id="editedText" placeholder="Your edited version will appear here..."></textarea>
                    <div class="char-counter" id="editedCounter">0 characters</div>
                </div>
            </section>

            <div class="button-group">
                <button class="btn-secondary" onclick="copyToEditor()">üìã Copy to Editor</button>
                <button class="btn-primary" onclick="copyResult()">üìÑ Copy Edited Text</button>
                <button class="btn-info" onclick="saveToHistory()">üíæ Save to History</button>
                <button class="btn-danger" onclick="clearAll()">üóëÔ∏è Clear All</button>
            </div>

            <div class="stats">
                <div class="stat-item">
                    <span class="stat-value" id="wordCount">0</span>
                    <div class="stat-label">Words</div>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="charCount">0</span>
                    <div class="stat-label">Characters</div>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="lineCount">0</span>
                    <div class="stat-label">Lines</div>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="readTime">0</span>
                    <div class="stat-label">Min Read</div>
                </div>
            </div>

            <section class="section">
                <h2 class="section-title">üìö Saved Prompts & Edit History</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div>
                        <h3 style="color: #74b9ff; margin-bottom: 10px; font-size: 1.1rem;">üí° Your Prompts</h3>
                        <div class="history" id="promptHistoryContainer">
                            <p style="text-align: center; color: #6c757d; padding: 20px;">No saved prompts yet. Create and save prompts to see them here!</p>
                        </div>
                    </div>
                    <div>
                        <h3 style="color: #74b9ff; margin-bottom: 10px; font-size: 1.1rem;">‚úèÔ∏è Edit History</h3>
                        <div class="history" id="historyContainer">
                            <p style="text-align: center; color: #6c757d; padding: 20px;">No saved edits yet. Save your work to see it here!</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        let editHistory = [];
        let promptHistory = [];
        let isGenerating = false;
        let currentSecurityMode = 'session';
        let sessionApiKey = '';
        
        const promptTemplates = [
            "Write a professional email about [TOPIC]",
            "Create a blog post about [TOPIC] with SEO keywords",
            "Generate a social media post for [PLATFORM] about [TOPIC]",
            "Write a product description for [PRODUCT]",
            "Create a press release announcing [NEWS/EVENT]",
            "Draft a cover letter for [JOB POSITION]",
            "Write a technical explanation of [CONCEPT] for beginners",
            "Create a marketing copy for [PRODUCT/SERVICE]",
            "Generate a creative story about [THEME]",
            "Write a summary of [DOCUMENT/ARTICLE]"
        ];

        // Character counters and stats
        function updateCounters() {
            const promptText = document.getElementById('promptText').value;
            const originalText = document.getElementById('originalText').value;
            const editedText = document.getElementById('editedText').value;
            
            document.getElementById('promptCounter').textContent = `${promptText.length} characters`;
            document.getElementById('originalCounter').textContent = `${originalText.length} characters`;
            document.getElementById('editedCounter').textContent = `${editedText.length} characters`;
            
            // Update stats based on edited text (or original if edited is empty)
            const textToAnalyze = editedText || originalText;
            const words = textToAnalyze.trim() ? textToAnalyze.trim().split(/\s+/).length : 0;
            const lines = textToAnalyze.split('\n').length;
            const readTime = Math.ceil(words / 200); // Average reading speed
            
            document.getElementById('wordCount').textContent = words;
            document.getElementById('charCount').textContent = textToAnalyze.length;
            document.getElementById('lineCount').textContent = lines;
            document.getElementById('readTime').textContent = readTime;
        }

        // Security mode management
        function updateSecurityMode() {
            const mode = document.querySelector('input[name="securityMode"]:checked').value;
            currentSecurityMode = mode;
            
            // Hide all modes
            document.querySelectorAll('.security-mode').forEach(el => el.style.display = 'none');
            
            // Show selected mode
            document.getElementById(mode + 'Mode').style.display = 'block';
            
            // Clear any stored keys when switching modes
            if (mode === 'session') {
                localStorage.removeItem('openai_api_key');
                localStorage.removeItem('encrypted_api_key');
            }
        }

        // Simple encryption (for demo - use stronger encryption in production)
        function simpleEncrypt(text, password) {
            let result = '';
            for (let i = 0; i < text.length; i++) {
                result += String.fromCharCode(text.charCodeAt(i) ^ password.charCodeAt(i % password.length));
            }
            return btoa(result);
        }

        function simpleDecrypt(encryptedText, password) {
            try {
                const text = atob(encryptedText);
                let result = '';
                for (let i = 0; i < text.length; i++) {
                    result += String.fromCharCode(text.charCodeAt(i) ^ password.charCodeAt(i % password.length));
                }
                return result;
            } catch {
                return null;
            }
        }

        // Get API key based on current security mode
        function getApiKey() {
            switch(currentSecurityMode) {
                case 'session':
                    return document.getElementById('apiKey').value || sessionApiKey;
                case 'encrypted':
                    const masterPassword = document.getElementById('masterPassword').value;
                    const apiKey = document.getElementById('encryptedApiKey').value;
                    if (masterPassword && apiKey) {
                        return apiKey;
                    }
                    // Try to decrypt stored key
                    const stored = localStorage.getItem('encrypted_api_key');
                    if (stored && masterPassword) {
                        return simpleDecrypt(stored, masterPassword);
                    }
                    return null;
                case 'environment':
                    // In a real app, this would be handled by the backend
                    return document.getElementById('envApiKey').value || process?.env?.OPENAI_API_KEY;
                default:
                    return null;
            }
        }

        // Get selected model based on current security mode
        function getSelectedModel() {
            switch(currentSecurityMode) {
                case 'session':
                    return document.getElementById('modelSelect').value;
                case 'encrypted':
                    return document.getElementById('encryptedModelSelect').value;
                case 'environment':
                    return document.getElementById('envModelSelect').value;
                default:
                    return 'gpt-4o-mini';
            }
        }

        // Save encrypted API key
        function saveEncryptedKey() {
            const masterPassword = document.getElementById('masterPassword').value;
            const apiKey = document.getElementById('encryptedApiKey').value;
            
            if (masterPassword && apiKey) {
                const encrypted = simpleEncrypt(apiKey, masterPassword);
                localStorage.setItem('encrypted_api_key', encrypted);
                return true;
            }
            return false;
        }

        // Show security information
        function showSecurityInfo() {
            const info = `üõ°Ô∏è SECURITY MODES EXPLAINED:

üì± SESSION ONLY (Recommended for most users):
‚Ä¢ API key stored only in browser memory
‚Ä¢ Automatically cleared when you close the tab
‚Ä¢ Most secure for personal use
‚Ä¢ You'll need to re-enter it each session

üîê ENCRYPTED STORAGE:
‚Ä¢ API key encrypted with your master password
‚Ä¢ Stored locally in encrypted form
‚Ä¢ Convenient but requires a strong master password
‚Ä¢ Only as secure as your master password

üåê ENVIRONMENT VARIABLE:
‚Ä¢ API key stored as server environment variable
‚Ä¢ Requires backend server setup
‚Ä¢ Best for production applications
‚Ä¢ Not applicable for client-side apps like this

üí° SECURITY TIPS:
‚Ä¢ Never share your API key with anyone
‚Ä¢ Use Session Only mode for maximum security
‚Ä¢ If using encrypted storage, use a strong master password
‚Ä¢ Monitor your OpenAI usage regularly
‚Ä¢ Regenerate your API key if compromised`;

            alert(info);
        }
        async function testApiKey() {
            const apiKey = document.getElementById('apiKey').value;
            if (!apiKey) {
                alert('Please enter your API key first!');
                return;
            }
            
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'üîÑ Testing...';
            button.disabled = true;
            
            try {
                const response = await fetch('https://api.openai.com/v1/models', {
                    headers: {
                        'Authorization': `Bearer ${apiKey}`
                    }
                });
                
                if (response.ok) {
                    button.textContent = '‚úÖ Valid!';
                    button.style.background = 'linear-gradient(135deg, #00b894, #00a085)';
                    localStorage.setItem('openai_api_key', apiKey);
                } else {
                    throw new Error('Invalid API key');
                }
            } catch (error) {
                button.textContent = '‚ùå Invalid';
                button.style.background = 'linear-gradient(135deg, #fd79a8, #e84393)';
                alert('Invalid API key. Please check and try again.');
            }
            
            setTimeout(() => {
                button.textContent = originalText;
                button.style.background = 'linear-gradient(135deg, #74b9ff, #0984e3)';
                button.disabled = false;
            }, 2000);
        }

        // Generate content with OpenAI API
        async function generateWithAI() {
            const apiKey = document.getElementById('apiKey').value || localStorage.getItem('openai_api_key');
            const prompt = document.getElementById('promptText').value;
            const model = document.getElementById('modelSelect').value;
            
            if (!apiKey) {
                alert('Please enter your OpenAI API key first!');
                return;
            }
            
            if (!prompt.trim()) {
                alert('Please write a prompt first!');
                return;
            }
            
            if (isGenerating) return;
            
            isGenerating = true;
            const button = document.getElementById('generateBtn');
            const originalText = button.textContent;
            button.textContent = '‚è≥ Generating...';
            button.disabled = true;
            
            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: model,
                        messages: [
                            {
                                role: 'user',
                                content: prompt
                            }
                        ],
                        max_tokens: 2000,
                        temperature: 0.7
                    })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    const generatedText = data.choices[0].message.content;
                    document.getElementById('originalText').value = generatedText;
                    updateCounters();
                    
                    // Auto-scroll to generated content
                    document.getElementById('originalText').scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'center' 
                    });
                    
                    button.textContent = '‚úÖ Generated!';
                    button.style.background = 'linear-gradient(135deg, #00b894, #00a085)';
                } else {
                    throw new Error(data.error?.message || 'API request failed');
                }
            } catch (error) {
                alert(`Error: ${error.message}`);
                button.textContent = '‚ùå Failed';
                button.style.background = 'linear-gradient(135deg, #fd79a8, #e84393)';
            }
            
            setTimeout(() => {
                button.textContent = originalText;
                button.style.background = 'linear-gradient(135deg, #74b9ff, #0984e3)';
                button.disabled = false;
                isGenerating = false;
            }, 2000);
        }

        // Show pricing information
        function showPricing() {
            const model = document.getElementById('modelSelect').value;
            let pricing = '';
            
            switch(model) {
                case 'gpt-4o':
                    pricing = 'GPT-4o: ~$15/1M input tokens, ~$60/1M output tokens\nHigh quality, best for complex tasks';
                    break;
                case 'gpt-4o-mini':
                    pricing = 'GPT-4o Mini: ~$0.15/1M input tokens, ~$0.60/1M output tokens\nGreat balance of quality and cost';
                    break;
                case 'gpt-3.5-turbo':
                    pricing = 'GPT-3.5 Turbo: ~$0.50/1M input tokens, ~$1.50/1M output tokens\nCheapest option, good for simple tasks';
                    break;
            }
            
            alert(`${pricing}\n\nNote: 1 token ‚âà 0.75 words\nTypical prompt: 50-200 tokens\nTypical response: 100-500 tokens\n\nMost requests cost just a few cents!`);
        }
        function savePrompt() {
            const promptText = document.getElementById('promptText').value;
            
            if (!promptText.trim()) {
                alert('Please write a prompt first!');
                return;
            }
            
            const timestamp = new Date().toLocaleString();
            const promptItem = {
                id: Date.now(),
                timestamp: timestamp,
                prompt: promptText
            };
            
            promptHistory.unshift(promptItem);
            if (promptHistory.length > 15) promptHistory.pop(); // Keep only 15 items
            
            updatePromptHistoryDisplay();
            
            // Visual feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = '‚úÖ Saved!';
            setTimeout(() => {
                button.textContent = originalText;
            }, 1500);
        }

        // Copy prompt to clipboard
        async function copyPrompt() {
            const promptText = document.getElementById('promptText').value;
            if (!promptText.trim()) {
                alert('No prompt to copy! Please write a prompt first.');
                return;
            }
            
            try {
                await navigator.clipboard.writeText(promptText);
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '‚úÖ Copied!';
                setTimeout(() => {
                    button.textContent = originalText;
                }, 1500);
            } catch (err) {
                alert('Failed to copy to clipboard');
            }
        }

        // Load prompt template
        function loadPromptTemplate() {
            const randomTemplate = promptTemplates[Math.floor(Math.random() * promptTemplates.length)];
            document.getElementById('promptText').value = randomTemplate;
            updateCounters();
            
            // Visual feedback
            const promptTextarea = document.getElementById('promptText');
            promptTextarea.style.background = '#fff3cd';
            setTimeout(() => {
                promptTextarea.style.background = '#f8f9fa';
            }, 1000);
        }

        // Update prompt history display
        function updatePromptHistoryDisplay() {
            const container = document.getElementById('promptHistoryContainer');
            
            if (promptHistory.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #6c757d; padding: 20px;">No saved prompts yet. Create and save prompts to see them here!</p>';
                return;
            }
            
            container.innerHTML = promptHistory.map(item => `
                <div class="history-item" onclick="loadPromptFromHistory(${item.id})">
                    <div class="history-time">${item.timestamp}</div>
                    <div class="history-preview">${item.prompt}</div>
                </div>
            `).join('');
        }

        // Load prompt from history
        function loadPromptFromHistory(id) {
            const item = promptHistory.find(h => h.id === id);
            if (item) {
                document.getElementById('promptText').value = item.prompt;
                updateCounters();
            }
        }
        function copyToEditor() {
            const originalText = document.getElementById('originalText').value;
            if (!originalText.trim()) {
                alert('Please paste some ChatGPT output first!');
                return;
            }
            document.getElementById('editedText').value = originalText;
            updateCounters();
            
            // Add animation feedback
            const editedTextarea = document.getElementById('editedText');
            editedTextarea.style.background = '#e8f5e8';
            setTimeout(() => {
                editedTextarea.style.background = '#f8f9fa';
            }, 500);
        }

        // Copy edited result to clipboard
        async function copyResult() {
            const editedText = document.getElementById('editedText').value;
            if (!editedText.trim()) {
                alert('Nothing to copy! Please edit some content first.');
                return;
            }
            
            try {
                await navigator.clipboard.writeText(editedText);
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '‚úÖ Copied!';
                button.style.background = 'linear-gradient(135deg, #00b894, #00a085)';
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = 'linear-gradient(135deg, #00b894, #00a085)';
                }, 1500);
            } catch (err) {
                alert('Failed to copy to clipboard');
            }
        }

        // Save to history
        function saveToHistory() {
            const originalText = document.getElementById('originalText').value;
            const editedText = document.getElementById('editedText').value;
            
            if (!editedText.trim()) {
                alert('Nothing to save! Please edit some content first.');
                return;
            }
            
            const timestamp = new Date().toLocaleString();
            const historyItem = {
                id: Date.now(),
                timestamp: timestamp,
                original: originalText,
                edited: editedText
            };
            
            editHistory.unshift(historyItem);
            if (editHistory.length > 10) editHistory.pop(); // Keep only 10 items
            
            updateHistoryDisplay();
        }

        // Update history display
        function updateHistoryDisplay() {
            const container = document.getElementById('historyContainer');
            
            if (editHistory.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #6c757d; padding: 20px;">No saved edits yet. Save your work to see it here!</p>';
                return;
            }
            
            container.innerHTML = editHistory.map(item => `
                <div class="history-item" onclick="loadFromHistory(${item.id})">
                    <div class="history-time">${item.timestamp}</div>
                    <div class="history-preview">${item.edited}</div>
                </div>
            `).join('');
        }

        // Load from history
        function loadFromHistory(id) {
            const item = editHistory.find(h => h.id === id);
            if (item) {
                document.getElementById('originalText').value = item.original;
                document.getElementById('editedText').value = item.edited;
                updateCounters();
            }
        }

        // Clear all content
        function clearAll() {
            if (confirm('Are you sure you want to clear all content?')) {
                document.getElementById('promptText').value = '';
                document.getElementById('originalText').value = '';
                document.getElementById('editedText').value = '';
                updateCounters();
            }
        }

        // Event listeners
        document.getElementById('promptText').addEventListener('input', updateCounters);
        document.getElementById('originalText').addEventListener('input', updateCounters);
        document.getElementById('editedText').addEventListener('input', updateCounters);

        // Auto-resize textareas
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.max(200, textarea.scrollHeight) + 'px';
        }

        document.getElementById('promptText').addEventListener('input', function() {
            autoResize(this);
        });
        document.getElementById('originalText').addEventListener('input', function() {
            autoResize(this);
        });
        document.getElementById('editedText').addEventListener('input', function() {
            autoResize(this);
        });

        // Initialize
        updateCounters();
        
        // Initialize security mode on page load
        window.addEventListener('load', function() {
            updateSecurityMode();
            
            // Try to load any stored encrypted key
            if (localStorage.getItem('encrypted_api_key')) {
                document.querySelector('input[value="encrypted"]').checked = true;
                updateSecurityMode();
            }
        });
    </script>
</body>
</html>